// [수정] 카톡 전송 시, 알림장 내용을 DB에도 저장 (그래야 학부모 화면에 뜸)
    window.sendNoticeKakao = async () => {
        if (window.Kakao && !Kakao.isInitialized()) Kakao.init('0a302951dba10cb82dbfc0b603784155');
        
        // 1. 알림장 내용 생성
        const msg = window.generateNotice();
        if(!msg) return; // 내용 없으면 중단

        // 2. DB에 '최근 알림(lastNotice)' 필드 업데이트
        try {
            await updateDoc(doc(db, "students", currentStudentId), {
                lastNotice: msg // 이 부분이 있어야 notice.html에서 글이 보입니다!
            });
        } catch(e) {
            console.log("DB 저장 실패(무시하고 카톡 전송):", e);
        }

        // 3. 공유 링크 생성 및 카톡 전송
        const share = await window.buildNoticeUrl(currentStudentId, 'parent');
        try {
            Kakao.Share.sendDefault({
                objectType: 'text',
                text: msg,
                link: { mobileWebUrl: share.url, webUrl: share.url },
                buttonTitle: '출결/학습 안내 보기'
            });
        } catch(e) { alert(e); }
    };
